<header>
    <h1>Users</h1>
</header>
<main>
    <ul>
        <li *ngFor="#user of users">
            {{ user.name.firstName }}
            {{ user.name.lastName }}
            {{ user.age }}
            <button type="button" (mousedown)="editUser(user)">
                EDIT
            </button>
        </li>
    </ul>
    <button type="button" (click)="prepareNewUser()" *ngIf="!newUser">
        Add new user
    </button>
    <template [ngIf]="newUser">
        <pre>newUser: {{ newUser | json }}</pre>
        <form (submit)="addOrUpdateUser(newUser, userForm)" #userForm="ngForm" novalidate>
            <label>First Name</label>
            <input type="text" required [(ngModel)]="newUser.name.firstName" ngControl="firstName" #fn="ngForm" />
            <hr/>
            <label>Last Name</label>
            <input type="text" required [(ngModel)]="newUser.name.lastName" ngControl="lastName" #ln="ngForm" />
            <hr/>
            <label>Age</label>
            <input type="number" required [(ngModel)]="newUser.age" ngControl="age" #a="ngForm" />
            <hr/>
            <div [ngSwitch]="newUser.isNew()">
                <button
                    type="submit"
                    *ngSwitchWhen="true"
                    [disabled]="!userForm.valid">
                    Add
                </button>
                <button
                    type="submit"
                    *ngSwitchWhen="false"
                    [disabled]="!userForm.valid">
                    Update
                </button>
            </div>
            <p *ngIf="fn.errors" [style.color]="'red'">
                First name is required
            </p>
            <p *ngIf="ln.errors" [style.color]="'red'">
                Last name is required
            </p>
            <p *ngIf="a.errors" [style.color]="'red'">
                Age is required
            </p>

        </form>
    </template>
</main>